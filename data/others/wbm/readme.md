# [Predicting stable crystalline compounds using chemical similarity](https://nature.com/articles/s41524-020-00481-6)

Published Jan 26, 2021 in Nature

A dataset generated with DFT building on earlier work by some of the same authors published in:

## [The optimal one dimensional periodic table: a modified Pettifor chemical scale from data mining](https://doi.org/10.1088/1367-2630/18/9/093011)

Published Sep 6, 2016 in New Journal of Physics.

## Original author advice for handling their data

Hai-Chen Wang <haichenwong@gmail.com>

To read the `json.bz2` files you can use the following code in Python:

```py
#!/usr/bin/env python

import json, bz2
from pymatgen.entries.computed_entries import ComputedStructureEntry

with bz2.open("step_1.json.bz2") as file_handle:
    data = json.loads(file_handle.read().decode("utf-8"))

entries = [ComputedStructureEntry.from_dict(entry) for entry in data["entries"]]

print(f"Found {len(entries)} entries")
print(f"\nEntry:\n{entries[0]}")
print(f"\nStructure:\n{entries[0].structure}")
```

Each file includes the calculations for a single substitution step. In the article we present the results for three steps. We ended by performing also a forth step, and a part of the fifth. These calculations are also included here. All results are using the PBE approximation. The number of entries per file is

- `step_1.json.bz2`: 61,848
- `step_2.json.bz2`: 52,800
- `step_3.json.bz2`: 79,205
- `step_4.json.bz2`: 40,328
- `step_5.json.bz2`: 23,308
- **total: 257,489**

In the `summary.txt` file, the meaning of the columns is

1. chemical composition of the material
2. number of sites in the primitive unit cell
3. volume of the primitive unit cell in Angstrom^3
4. total energy in eV
5. energy of formation in eV
6. distance to the convex hull in eV
7. indirect band gap in eV

Note that the distance to the hull (and to a much lesser extent the formation energy) depend on the reservoir compounds used to calculate the convex hull. In this case, we used the materials in the Materials Project database together with our own internal database. Note that the distances to the hull may be negative, as we exclude the composition from the hull during the calculation.

## Can the WBM hull be trusted?

The WBM hull appears to be quite different from the "MP+WBM PPD 2021-04-27" hull generated by Rhys:

```py
(df_ppd_hull.e_above_hull - df_wbm_summary.e_above_hull).describe()
count          257,489
mean             0.021
std              0.460
min             -5.294
25%             -0.006
50%              0.000
75%              0.003
max             10.956
```

## File Index

`wbm-steps-summary.csv` and `wbm-all-steps.json.bz2` contain the same data, except the CSV file is missing the `pymatgen` `ComputedStructureEntries` (CSEs). It's therefore much smaller and faster to load.
